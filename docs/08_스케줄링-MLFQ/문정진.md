# 스케줄링 : 멀티 레벨 피드백 큐
MLFQ = Multi level Feedback Queue<br/>    
MLFQ 가 해결하는 문제 두 가지<br/>
* 짧은 작업 선실행으로 반환 시간 최적화<br/>  
* 대화형 사용자 응답 시간 최적화<br/>
<br/>

## 11.1 MLFQ : 기본 규칙
* 여러 개의 큐 구성 = 큐 마다 우선순위가 배정.<br/>  
* 프로세스들의 우선순위 결정, 높은 우선순위가 높은 우선순위 큐에 선택.<br/> 
* 하나의 큐에 두 개 이상의 작업이 존재. 해당 작업 사이에 라운드 로빈(Round-Robin) 사용.<br/>  
<br/>

* MLFQ 우선 순위 규칙 (동적 우선 순위 부여)  
 한 작업이 반복적으로 cpu 양보하면, 작업 우선순위 높게 유지, 한 작업이 cpu 집중적 사용 시 우선순위 낮춤<br/>
    1. priority a > priority b : a 실행<br/>
    2. priority a = priority b : a와 b 라운드 로빈 방식으로 실행.<br/>
<br/>

## 11.2 시도 1: 우선순위 변경
* MLFQ 우선 순위 규칙<br/>
 스케줄러는 작업이 짧은 지, 긴 지 알 수 없어 짧은 작업으로 가정하여 높은 우선순위 부여,<br/>
 짧다면 빨리 실행 후 종료, 길다면 아래 큐로 이동<br/>
    3. 작업이 시스템 진입 시, 가장 높은 우선순위에 놓임.<br/>
    4. -a 타임 슬라이스 모두 소모 시. 우선순위 한 단게 아래 큐로 이동.<br/>
    4. -b 타임 슬라이스 소진 전 cpu 양도 시. 우선 순위 유지.<br/>
<br/>

* 위 내용 까지의 MLFQ 문제점<br/>
1. <span style="color: #ffd33d">기아 현상(starvation)</span><br/>
    * 짧은 작업들(대화형 작업)이 cpu 시간을 소모해, 긴 작업들이 cpu 할당 받지 못해 굶어 죽는 현상.<br/>
2. 스케줄러 유리하게 동작하게끔 프로그램 작성<br/>
    * 타임 슬라이스 끝나기 전 cpu 양도, 우선 순위 규칙 4-b에 해당하여 해당 큐에 cpu 독점하게됨.<br/>
3. 프로그램 시간 흐름에 따라 특선 변함.<br/>
    * cpu 위주 작업이 대화형으로 변경 될 수 있음.<br/>
<br/>

## 11.3 시도 2: 우선 순위 상향 조정
기아 문제 방지 어떻게? -> <span style="color: #ffd33d">상향 조정(boost)</span><br/>
샹향 조정 : 주기적으로 모든 작업의 우선 순위를 상향 조정.<br/>
    5. 일정 기간 s가 지나면, 시스템의; 모든 작업 최상위 큐로 이동.<br/>

    s란 각 레벨에서 프로세스가 할당받는 타임 슬라이스(time slice) 을 의미.
<br/>
두 가지 문제 해결.<br/>

1. 기아 문제 해결<br/>
    * 최상위 큐 작업은 다른 높은 우선순위 작업들과 라운드 로빈 방식으로 cpu 공유 받음.<br/>
2. cpu위주 작업이 대화형 작업 변경 시, 우선 순위 상향<br/>
3. s값 결정 필요(부두 상수)
    * s값이 크면 작업이 굶을 수 있고, 작으면 대화형 작업이 cpu 시간 사용할 수 없음.<br/>
<br/>

## 11.5 MLFQ 조정과 다른 쟁점들
필요한 변수들을 스케줄러가 어떻게 설정해야하는지<br/>
1. 몇 개의 큐가 존재하는가?<br/>
2. 큐당 타임 슬라이스 크기는 얼마로 해야하는가?<br/>
    * 우선 순위 높은 큐 -> 짧은 타임 슬라이스 -> 즉 대화형 작업.<br/>
    * 낮은 순위 큐 -> cpu 오래 실행 -> 긴 타임 슬라이스 필요.<br/>
3. 기아 피하기 위해 우선순위를 얼마나 자주 상향 조정해야하는 가?<br/>
<br/>

## 11.6 MLFQ 요약.

1. priority a > priority b : a 실행<br/>
2. priority a = priority b : a와 b 라운드 로빈 방식으로 실행.<br/>
3. 작업이 시스템에 들어가면 최상위 큐 배치.<br/>
4. 작업이 지정된 단계에서 배정받은 시간 소진시, 작업의 우선순위 감소.<br/>
5. 일정 주기 s가 지나면, 시스템의 모든 작업을 최상위 큐로 이동.<br/>